# IAM_Drone

드론에서 사욛될 Python 프로그램입니다.

현재 이 코드는 드론의 녹화 관련 코드가 생략된 코드입니다. 

이는 현재 구현 상 녹화 기능을 사용하려면 카메라가 2개 필요하기 때문에, 따로 웹캠 같은 장비가 없으시다면 코드 실행이 불가능하기 때문입니다.

## 의존성
다음의 의존성을 필요로 합니다.
1. `openCV` : 카메라 및 인코딩에 사용
2. `numpy` : openCV의 의존성
3. `bleak` : 블루투스 자동 연결
4. `netifaces` : 네트워크 연결 관련

### 설치방법
pip를 이용해 설치할 수 있습니다.

`pip install opencv-python`

`pip install bleak`

`pip install netifaces`

## 파일에 대한 설명
`DroneServerNoRecord`
: 메인 소스코드입니다. 드론의 기본적인 정보의 송수신을 담당합니다.

`SendStreamByCPU`
: 영상 스트리밍 코드입니다. 현재는 `openCV`를 이용한 CPU 가속을 사용하고 있습니다. `turboJPEG`를 사용한 가속을 사용하였으나, 현재는 어떠한 이유에서인지 정상작동하고 있지 않습니다. 추후 수정 예정입니다.

`Utility`
: 연결에 필요한 각종 유틸리티 툴을 다루는 코드입니다. 자신의 IP주소를 획득하고, 포트를 점유하는 프로세스를 강제 종료하고, 인터넷 연결 상태가 어떠한지 점검하는 코드입니다.

`control`
: 스마트폰으로 부터 수신된 JSON 자료를 파싱하는 코드입니다. 

`drone`
: `control`로부터 수신된 명령을 해석하여 드론에게 명령을 내리는 함수입니다. 아직 미구현 상태로, 여러 코드가 존재하나 전부 작동하지 않으며 현재는 드론의 상태를 나타내는 전역변수만 사용하고 있습니다. 추후 새롭게 구현될 부분입니다.

`ipAutoFinder`
: 블루투스(BLE)를 사용해 자동으로 연결을 행하는 코드입니다. 블루투스 연결이 없을 시 수동 연결입니다.

## 사용법
`drone`을 import 한 후, `drone`의 객체 값을 수정하여 사용자에게 데이터를 보냅니다.
`control`을 import한 후, 해당 파일에서 변수를 통해 조종기의 값을 읽을 수 있습니다.

`drone.pitch`
: 드론의 피치 방향 자세를 저장하는 변수입니다.

`drone.roll`
: 드론의 롤 방향 자세를 저장하는 변수입니다.

`drone.yaw`
: 드론의 요 방향 자세를 저장하는 변수입니다.
